<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SLAUGHTERHOUSE - ELMASCAPO</title>
    <style>
        body { margin: 0; background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; font-family: sans-serif; }
        #game-container { position: relative; width: 800px; height: 400px; border: 3px solid #400; background: #000; }
        #intro-screen { position: absolute; width: 100%; height: 100%; background: radial-gradient(circle, #200, #000); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; color: white; }
        #game-title { font-size: 50px; text-shadow: 0 0 20px #f00; margin: 0; }
        #play-button { width: 90px; height: 90px; background: #0f0; border: 4px solid #fff; border-radius: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 40px; margin: 20px; box-shadow: 0 0 20px #0f0; }
        #ui { position: absolute; top: 15px; left: 20px; color: #fff; font-size: 18px; z-index: 10; }
        .hidden { display: none !important; }
        canvas { display: block; }
    </style>
</head>
<body>
<div id="game-container">
    <div id="intro-screen">
        <h1 id="game-title">SLAUGHTERHOUSE</h1>
        <div id="play-button">â–¶</div>
        <div id="stats-intro">ATTEMPTS: 1</div>
    </div>
    <div id="ui" class="hidden">PROGRESS: 0%</div>
    <canvas id="geometryCanvas"></canvas>
</div>
<script>
    window.onload = function() {
        const canvas = document.getElementById("geometryCanvas");
        const ctx = canvas.getContext("2d");
        const ui = document.getElementById("ui");
        const intro = document.getElementById("intro-screen");
        const statsIntro = document.getElementById("stats-intro");
        const playBtn = document.getElementById("play-button");
        const title = document.getElementById("game-title");
        canvas.width = 800; canvas.height = 400;
        const menuMusic = new Audio('https://www.mboxdrive.com/Geometry%20Dash%20Main%20Theme.mp3');
        const levelMusic = new Audio('https://www.mboxdrive.com/Dimrain47-At-The-Speed-Of-Light.mp3');
        menuMusic.loop = true; levelMusic.loop = true;
        let game = { active: false, dist: 0, speed: 11, attempts: 1, mode: 'cube' };
        let player = { x: 150, y: 310, w: 18, h: 18, dy: 0, gravity: 0.8, rotation: 0 };
        let keys = {}; let trail = [];
        const press = () => { keys['Space'] = true; };
        const release = () => { keys['Space'] = false; };
        window.addEventListener('keydown', (e) => { if(e.code === 'Space') press(); });
        window.addEventListener('keyup', (e) => { if(e.code === 'Space') release(); });
        window.addEventListener('mousedown', (e) => { e.preventDefault(); press(); });
        window.addEventListener('mouseup', (e) => { e.preventDefault(); release(); });
        playBtn.addEventListener('mousedown', start);
        const map = [];
        function addS(x, y, top = false) { map.push({x, y, t: 'S', top}); }
        function addP(x, m) { map.push({x, t: 'P', mode: m}); }
        for(let i=0; i<30; i++) addS(800 + (i*400), 314);
        addP(6000, 'ship');
        for(let i=0; i<50; i++) {
            let x = 6500 + (i * 180);
            let y = 180 + Math.sin(i * 0.4) * 90;
            addS(x, y + 35, false); addS(x, y - 65, true);
        }
        addP(16000, 'wave');
        for(let i=0; i<100; i++) {
            let x = 16500 + (i * 110);
            let gap = (i > 60) ? 22 : 32; 
            let y = 200 + Math.cos(i * 0.3) * 100;
            addS(x, y + gap, false); addS(x, y - gap - 40, true);
        }
        function start() {
            if(game.active) return;
            title.innerText = "SLAUGHTERHOUSE"; title.style.color = "#fff";
            intro.classList.add('hidden'); ui.classList.remove('hidden');
            menuMusic.pause(); levelMusic.currentTime = 0; levelMusic.play();
            game.dist = 0; player.y = 310; player.dy = 0;
            game.mode = 'cube'; trail = []; game.active = true;
        }
        function gameOver() {
            game.active = false; game.attempts++;
            statsIntro.innerText = `ATTEMPTS: ${game.attempts}`;
            intro.classList.remove('hidden');
            levelMusic.pause(); menuMusic.play();
        }
        function update() {
            if (!game.active) return;
            if (game.mode === 'cube') {
                player.dy += 1.3; player.y += player.dy;
                if (player.y > 332) { player.y = 332; player.dy = 0; if (keys['Space']) player.dy = -15.5; }
                player.rotation += 18;
            } else if (game.mode === 'ship') {
                player.dy += keys['Space'] ? -0.75 : 0.75;
                player.dy *= 0.97; player.y += player.dy;
                player.rotation = player.dy * 2.5;
            } else {
                player.dy = keys['Space'] ? -9.5 : 9.5; player.y += player.dy;
                trail.push({x: player.x, y: player.y + 9});
                if (trail.length > 20) trail.shift();
            }
            game.dist += game.speed;
            let prog = Math.min(100, Math.floor((game.dist / 28000) * 100));
            ui.innerText = `PROGRESS: ${prog}% | ATT: ${game.attempts}`;
            map.forEach(o => {
                let ox = o.x - game.dist;
                if (ox > 120 && ox < 190) {
                    if (o.t === 'P') { game.mode = o.mode; player.dy = 0; }
                    if (o.t === 'S') {
                        if (player.x + 4 < ox + 26 && player.x + player.w - 4 > ox + 4 &&
                            player.y + 4 < o.y + 26 && player.y + player.h - 4 > o.y + 4) gameOver();
                    }
                }
            });
            if (player.y < 0 || player.y > 380) gameOver();
            if (prog >= 100) { game.active = false; title.innerText = "VERIFIED"; title.style.color = "gold"; intro.classList.remove('hidden'); levelMusic.pause(); }
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#0a0000"; ctx.fillRect(0, 350, canvas.width, 50);
            if (game.mode === 'wave' && trail.length > 1) {
                ctx.strokeStyle = "#f00"; ctx.lineWidth = 4; ctx.beginPath();
                trail.forEach((p, i) => { let tx = p.x - (trail.length - i) * 2.5; if (i === 0) ctx.moveTo(tx, p.y); else ctx.lineTo(tx, p.y); });
                ctx.stroke();
            }
            map.forEach(o => {
                let ox = o.x - game.dist;
                if (ox > -50 && ox < 850) {
                    if (o.t === 'P') { ctx.fillStyle = o.mode === 'ship' ? "#f0f" : "#0ff"; ctx.fillRect(ox, 0, 40, 400); }
                    else {
                        ctx.fillStyle = "#f00"; ctx.beginPath();
                        if (o.top) { ctx.moveTo(ox, o.y); ctx.lineTo(ox+15, o.y+35); ctx.lineTo(ox+30, o.y); }
                        else { ctx.moveTo(ox, o.y+35); ctx.lineTo(ox+15, o.y); ctx.lineTo(ox+30, o.y+35); }
                        ctx.fill();
                    }
                }
            });
            ctx.save(); ctx.translate(player.x + 9, player.y + 9);
            ctx.rotate(player.rotation * Math.PI / 180);
            ctx.fillStyle = "#000"; ctx.strokeStyle = "#fff"; ctx.lineWidth = 2;
            if (game.mode === 'cube') { ctx.fillRect(-9, -9, 18, 18); ctx.strokeRect(-9, -9, 18, 18); }
            else if (game.mode === 'ship') { ctx.beginPath(); ctx.moveTo(-12, 6); ctx.lineTo(12, 0); ctx.lineTo(-12, -6); ctx.fill(); ctx.stroke(); }
            else { ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.moveTo(12, 0); ctx.lineTo(-10, -9); ctx.lineTo(-10, 9); ctx.fill(); }
            ctx.restore();
        }
        function loop() { update(); draw(); requestAnimationFrame(loop); }
        loop();
        window.onclick = () => { if(menuMusic.paused && !game.active) menuMusic.play(); };
    };
</script>
</body>
</html>
